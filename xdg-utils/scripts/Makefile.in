MKDIR      	= mkdir -p
RMDIR      	= rmdir
INSTALL         = @INSTALL@ $(INSTALL_FLAGS)
INSTALL_PROGRAM = @INSTALL_PROGRAM@ $(INSTALL_PROGRAM_FLAGS)
INSTALL_LIBRARY = @INSTALL_PROGRAM@ $(INSTALL_PROGRAM_FLAGS)
INSTALL_SCRIPT  = @INSTALL_SCRIPT@ $(INSTALL_SCRIPT_FLAGS)
INSTALL_DATA    = @INSTALL_DATA@ $(INSTALL_DATA_FLAGS)


prefix          = @prefix@
exec_prefix     = @exec_prefix@
bindir          = @bindir@

SCRIPTS		= \
    xdg-menu \
    xdg-email \
    xdg-mime \
    xdg-su \
    xdg-open \
    xdg-copy

do_subst = sed -e '/[@]xdg-utils-common[@]/ r xdg-utils-common'

all:	$(SCRIPTS)

distclean: clean
	rm -f Makefile

clean:
	rm -f $(SCRIPTS)
	rm -f README

README: $(SCRIPTS)
	echo > $@
	@for x in $(SCRIPTS) ; do \
	    echo $$x: >> $@ ; \
	    sh ./$$x | sed 's/^/    /' >> $@ ; \
	    echo >> $@ ; \
	    echo >> $@ ; \
	done

install: $(SCRIPTS)
	$(MKDIR) $(bindir)
	for x in $(SCRIPTS) ; do \
	    $(INSTALL_SCRIPT) $$x $(bindir) ; \
	done

uninstall:
	for x in $(SCRIPTS) ; do \
	    rm -f $(bindir)/$$x ; \
	done
	-$(RMDIR) $(bindir)

%: %.in
	$(do_subst) < $< >$@
	chmod a+x $@

xdg-menu: xdg-menu.in xdg-utils-common
xdg-email: xdg-email.in xdg-utils-common
xdg-mime: xdg-mime.in xdg-utils-common
xdg-su: xdg-su.in xdg-utils-common
xdg-open: xdg-open.in xdg-utils-common
xdg-copy: xdg-copy.in xdg-utils-common
