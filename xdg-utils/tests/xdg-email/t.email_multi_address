#!/bin/bash

## Include utility functions.
. "$XDG_TEST_DIR/include/testassertions.sh"
. "$XDG_TEST_DIR/include/testcontrol.sh"

## Test function
test_multi_address() {
test_start "$FUNCTNAME: verify cc/bcc/subject/body/attach arguments work"

ADDR="$XDG_TEST_ID@portland.freedesktop.org"

test_init

## Require a running X server
assert_display

test_procedure

assert_exit 0 xdg-email --cc "$PRE-cc-$ADDR" --bcc "$PRE-bcc-$ADDR" \
 --cc "$PRE-cc2-$ADDR" --bcc "$PRE-bcc2-$ADDR" --subject 'I am the subject' \
 --body 'I am the body' "$PRE-$ADDR" "$PRE-2-$ADDR"

assert_nostdout
assert_nostderr

assert_interactive "Did a new email open with the body/subject complete and two email addresses in TO/CC/BCC?" y

test_result
}

repeat_test test_multi_address 1 PRE "t"
